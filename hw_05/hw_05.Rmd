---
title: "Fifth Week: Bootstrap and Resampling Methods"
subtitle: "Nonparametric Hypothesis tests"
author: "Aryan Tajmirriahi"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/NonparametricStatistics_iStock.jpg"  align = 'center'>
</div>

> <p dir="RTL"> 
لطفا با سوالات زیر پاسخ دهید.
در همه سوالات سطح دقت را ۹۵ درصد در نظر بگیرید.
</p>

***

<p dir="RTL">
۱. شرکتی میخواهد تحقیق کند آیا درآمد نمایندگی های آن یکسان است. برای بررسی این موضوع هشت نمایندگی
به طور تصادفی انتخاب شده اند که به ترتیب میزان فروش آنها عبارت است از 
102, 300, 102, 100, 205, 105, 71 , 92.
با توجه به داده آیا عملکرد نمایندگی ها یکسان است؟
</p>

***

<p dir="RTL">
۲. آمار فروش شرکتی در دو نوع شعبه سنتی و مدرن در زیر آمده است:
</p>

Classical stores: 50, 50, 60, 70, 75, 80, 90, 85

Modern stores: 55, 75, 80, 90, 105, 65

<p dir="RTL">
آیا تفاوتی در عملکرد دو نوع شعبه وجود دارد؟
</p>

<p dir="RTL">
برای این سوال از permutation test به مانند آنچه در کلاس تدریس شده بود استفاده شد و نتوانستیم فرض صفر را رد کنیم پس اثبات نشد که تفاوتی بین این دو نوع شعبه وجود دارد.
</p>

```{r}
#2
A = c(50, 50, 60, 70, 75, 80, 90, 85, 55, 75, 80, 90, 105, 65)
x= combn(A, 7, mean)
m = mean(c(55, 75, 80, 90, 105, 65))
print(mean(x < m))
```



***

<p dir="RTL">
۳. اطلاعات حسابداری ۱۵ شعبه که به صورت تصادفی انتخاب شده اند به شرح زیر است:
</p>

509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904

<p dir="RTL">
شرکت مذکور برای ارتقای فروش خود یک طرح تبلیغاتی جدید را اجرا میکند. پس از طرح جدید نتایج عملکرد شعبه ها  به صورت زیر 
اندازه گیری شده است
</p>

517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901

<p dir="RTL">
آیا تبلیغات جدید عملکرد فروش را بالا برده است؟
</p>


<p dir="RTL">
برای این سوال هم مانند بالا از permutation test معمولی استفاده شد و باز هم نتوانستیم فرض صفر را رد کنیم.
</p>

```{r}
A = c(509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904, 517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901)
x= c()
i <- 0
while(i < 10000){
    z = rnorm(length(A), mean = 0)
    j <- 1
    sum1 <- 0
    sum2 <- 0
    while(j <= length(A)){
      if(z[j] > 0){
        sum1 <- sum1 + A[j]
        sum2 <- sum2 + 1
      }
      j <- j + 1
    }
    x[i] <- sum1 / sum2
    i <- i + 1
}
m = mean(c(517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901))
print(mean(x < m))
```


***

<p dir="RTL">
۴. محصولی در سه رنگ سفید آبی و قرمز تولید شده است.
پنج شعبه ار فروشگاه سازنده محصول به صورت تصادفی انتخاب شده و اطلاعات فروش آنها در زیر آمده است.
</p>

| Store | White | Blue | Red |
| :----: | :----: | :----: | :----: |
| 1. |	510 |	925 |	730 |
| 2. | 720 | 735 | 745 |
| 3. |	930 |	753 |	875 |
| 4. |	754 |	685 |	610 |
| 5. |	105	|  |  |

<p dir="RTL">
با توجه به داده های بالا آیا رنگی خاص در میزان فروش محصولات تاثیر دارد؟
</p>

<p dir="RTL">
برای این سوال با توجه به چند کلاسه بودن داده از تست فریدمن استفااده شد ولی نتوانستیم گزاره را رد یا اثبات کنیم.البته دقت کنید ما بجای اعدادی که نبودند صفر گذاشتیم و اگر NA می گذاشتیم نتایج فرق می کرد.
</p>

```{r}
w = c(510, 720, 930, 754, 105)
b = c(925, 735, 753, 685, 0)
r = c(730, 745, 875, 610, 0)
A = data.frame(w, b, r)
friedman.test(as.matrix(A))
```


***

<p dir="RTL">
۵. یک موسسه نظرسنجی نظرات مردم در مورد رضایت از یک محصول که در ماه های فروردین اردیبهشت خرداد و تیر که از طریق تلویزیون 
تبلیغ شده است را مورد ارزیابی قرار می دهد.این کار بدین صورت است از افرادی در ماه اول سوال پرسیده می شود و در ماه آینده نیز از همان فرد سوال می شود که آیا از محصول مذکور راضی هستی یا خیر.
با توجه به داده ایی که در پیوست تمرین آمده است آیا تبلیغات تاثیر مثبتی در افزایش رضایت مردم داشته است؟
</p>

<p dir="RTL">
برای این سوال از تست فریدمن استفاده شد ولی با توجه به نتایج نمی توان گزاره را رد یا اثبات کرد.
</p>

```{r}
#5
library(readr)
tv = read.csv("E://edu//TahlilDade//tv.csv")
friedman.test(as.matrix(tv))
```


***

<p dir="RTL"> 
۶. شرکتی در حال تحقیق بر روی این موضوع است که آیا جمعیت شهر تاثیری در نوع میزان مصرف محصولات شرکت دارد.
با توجه به داده زیر این موضوع را تحقیق کنید؟
</p>


| City size |	| Frequency of service usage | |
| :---: |  :---:  | :---: | :---: | 
| | Always	| Sometime | Never |
| Small	| 151	| 252	| 603 |
| Medium	| 802	| 603	| 405 |
| Large	| 753	| 55	| 408 |

<p dir="RTL"> 
برای این سوال از تست استقلال ChiSquare استفاده کردیم و ثابت شد که جمعیت بر میزان و نوع مصرف تاثیر می گذارد.
</p>

```{r}
#6
Always = c(151, 802, 753)
Sometimes = c(252, 603, 55)
Never = c(603, 405 ,408)
data = data.frame(Always, Sometimes, Never)
chisq.test(data)
```


***

<p dir="RTL"> 
۷. شرکتی انتظار دارد با ارایه محصول الف میزان فروش محصول ب افزایش یابد.
به همین منظور به طور تصادفی از صد مشتری خود اطلاعات مصرف جمع آوری می نماید.
با توجه به داده های که داده شده آیا ربط معناداری بین فروش این دو محصول وجود دارد؟
</p>

<p dir="RTL"> 
 برای این سوال از کورلیشن اسپیرمن استفاده کردیم و مشاهده شد ربط خیلی کمی بین این دو مورد وجود دارد.
</p>

```{r}
#7
con = read.csv("E://edu//TahlilDade//consumption.csv")
cor(con$A, con$B, method = "spearman")
```


***

<p dir="RTL"> 
۸. یک شرکت از ۲۰۰۰ نفر از مشتریان خود عامل خرید محصول را مورد سوال قرار میدهد 
که خلاصه اطلاعات آن را در زیر می توانید مشاهده کنید
</p>

| Characteristics	| Male	| Female |
| :---: |  :---:  | :---: |
| Price	| 301	| 502 |
| Design	| 353	| 155 |
| Color	| 558	| 153 |

<p dir="RTL"> 
آیا جنسیت تاثیری در مشخصه کاربری کالا دارد؟
</p>

<p dir="RTL"> 
برای اینکار از تست استقلال ChiSquare استفاده کردیم و اثبات شد که جنسیت بر نوع خرید تاثیر می گذارد.
</p>

```{r}
#8
Male = c(301, 353, 558)
Female = c(502, 155, 153)
data = data.frame(Male, Female)
chisq.test(data)
```





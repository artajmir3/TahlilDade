---
title: "first week: Introduction to R and Rstudio"
author: "Aryan Tajmirriahi"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/Rman.jpeg"  align = 'center'>
</div>


<h1 dir="RTL"> 
?????????? ?????? ??????: ?????? ??????????
</h1>

<p dir="RTL"> 
???? ???????? ?????? ?????? ???? ???? ???????? ?????????? ???? ???? ???????? ????????.
</p>

***

<h2 dir="RTL">
???????????? ??????????????
</h2>

<p dir="RTL">
???? ????????????
$(n,n)$
???? ???????? ?????????? 
$1,2,...,n^2$
??????. ?????????????? ???????????? ?????????? ?????? ?????????? ?????????? ???? ?????????? ???????? ?????? ???? ?????????? ????????. ???????? ???????? ???? ???????????? ?????? ?????????????? ???? ?????? ?????????? ?????????? ????????. 
</p>

```{r}
library(magic)
print(magic.4n(1))
print(magic.2np1(2))
print(magic.4np2(1))
```


***

<h2 dir="RTL">
????????????  ????????
</h2>

<p dir="RTL">
???????????? ???????? ???? ?????????? ?? ???? ???? ???? ???????? ???????? ???? ???? ?????????? ?????? ?????? ????????:
</p>

$$ a = (a_1, a_2,..., a_{13})$$
$$\frac{a_1}{a_2+a_3} = \frac{a_2+a_3}{a_3+a_4+a_5}<1$$
$$\frac{a_6}{a_6+a_7}= \frac{a_6+a_7}{a_7+a_8+a_9} = \frac{a_7+a_8+a_9}{a_5+a_9+a_{10}} <1$$

$$\frac{a_{11}+a_{12}}{a_{12}+a_{13}}=\frac{a_{12}+a_{13}}{a_{13}+a_{10}}<1$$

```{r}
num_to_perm <- function(x, n){
  out = numeric(n)
  pp <- p <- c(1:n)
  mask <- rep(-1, n)
  i <- 1
  while(i <= n){
    idx <- as.integer(x / gamma(n - i + 1)) + 1
    xx = as.integer(p[idx])
    x <- x - gamma(n - i + 1) * (idx - 1)
    mask[xx] = 0
    p = pp[mask < 0]
    out[i] <- xx
    i <- i + 1
  }
  return(out)
}

n <- 13
out <- numeric(0)
j <- 1
k <- gamma(n + 1)
i <- 0
while (i < gamma(n + 1)){
  perm = num_to_perm(i, n)
  if (perm[1] / (perm[2] + perm[3]) >= 1){
    i <- i + gamma(n - 3 + 1)
  }
  else if (sum(perm[2:3]) / sum(perm[3:5]) != perm[1] / sum(perm[2:3])){
    i <- i + gamma(n - 5 + 1)
  }
  else if (perm[6] / (perm[6] + perm[7]) >= 1){
    i <- i + gamma(n - 7 + 1)
  }
  else if (sum(perm[6:7]) / sum(perm[7:9]) != perm[6] / sum(perm[6:7])){
    i <- i + gamma(n - 9 + 1)
  }
  else if (sum(perm[7:9]) / (sum(perm[9:10]) + perm[5]) != perm[6] / sum(perm[6:7])){
    i <- i + gamma(n - 10 + 1)
  }
  else if (sum(perm[11:12]) / sum(perm[12:13]) >= 1){
    i <- i + gamma(n - 13 + 1)
  }
  else if (sum(perm[11:12]) / sum(perm[12:13]) != sum(perm[12:13]) / (perm[13] + perm[10]) ){
    i <- i + gamma(n - 13 + 1)
  }else{
    print(perm)
    i <- i + 1
  }
}

```


***

<h2 dir="RTL">
???? ????????
</h2>

<p dir="RTL">
?????????????? ???????? ???? ?????? ???????????? ?? ???????????? ?????????? ?????? ??????. ???? ?????? ???????? ?????????? ???? ?????? ???????? ???????? ???? ???????????? ??????????. ?????? ?????? ???????????? ???? ?????? ???????? ??????????
</p>

```{r}
to_bin <- function(x, n){
  i <- 1
  out <- numeric(n)
  while (i <= n){
    new_x = as.integer(x / 2)
    out[i] = x - 2 * new_x
    x <- new_x
    i <- i + 1
  }
  return(out)
}

i <- 0
n <- 16
values = c()
print('possible configs:')
while(i< 2 ** n){
  out <- to_bin(i, n)
  flag = TRUE
  if (out[n] == 1){
    if (out[n-1] == 1 || out[1] == 1){
      flag = FALSE
    }
  }else{
    if (out[n-1] == 0 && out[1] == 0){
      flag = FALSE
    }
  }
  if(out[1] == 1){
    if (out[n] == 1 || out[2] == 1){
      flag = FALSE
    }
  }else{
    if (out[n] == 0 && out[2] == 0){
      flag = FALSE
    }
  }
  j <- n - 1
  while (j > 1){
    if(out[j] == 1){
      if(out[j-1] == 1){
        flag = FALSE
      }
      if (out[j+1] == 1){
        flag = FALSE
      }
    }else{
      if (out[j-1]==0 && out[j+1] == 0){
        flag = FALSE
      }
    }
    j <- j - 1
  }
  if (flag == TRUE){
    print(out)
    values <- union(values, c(n - sum(out)))
  }
  i <- i + 1
}
print('possible number of liars:')
print(values)

```


<p dir="RTL">
???????????? ?????????? ???????? ???? ?????? ?????? ???????????? ?? ???????????? ?????????? ?????? ???? ???????? ???? ???? ?????? ???????? ?????????? ???? ???????? ???? ?????? ???????? ???????? ???? ?????? ???????????? ?? ???? ?????? ???????????? ??????????. ?????? ?????? ???????????? ???? ?????? ???????? ??????????
</p>

```{r}
to_bin <- function(x, n){
  i <- 1
  out <- numeric(n)
  while (i <= n){
    new_x = as.integer(x / 2)
    out[i] = x - 2 * new_x
    x <- new_x
    i <- i + 1
  }
  return(out)
}

i <- 0
n <- 12
values = c()
print('possible configs:')
while(i< 2 ** n){
  out <- to_bin(i, n)
  flag = TRUE
  if (out[n] == 1){
    if (out[n-1] + out[1] != 1){
      flag = FALSE
    }
  }else{
    if (out[n-1] + out[1] == 1){
      flag = FALSE
    }
  }
  if(out[1] == 1){
    if (out[n] + out[2] != 1){
      flag = FALSE
    }
  }else{
    if (out[n] + out[2] == 1){
      flag = FALSE
    }
  }
  j <- n - 1
  while (j > 1){
    if(out[j] == 1){
      if(out[j-1] + out[j+1] != 1){
        flag = FALSE
      }
    }else{
      if (out[j-1] + out[j+1] == 1){
        flag = FALSE
      }
    }
    j <- j - 1
  }
  if (flag == TRUE){
    print(out)
    values <- union(values, c(n - sum(out)))
  }
  i <- i + 1
}
print('possible number of liars:')
print(values)

```


<p dir="RTL">
?????? ???????? ?????????????? ?????? ???????? ?????????? ?????? ???? ???????? ?????? ???? ???????? ?????? ???????? ???????????? ???? ???? ???????? ???? ?????? ???????? ???????? ?????? ???????????? ?? ?????????? ???????????????? ?? ???????? ?????? ???????? ?????????? ???????????? ???? ???? ???? ?????? ???????? ???????? ???????? ???????????? ??????????. ?????? ?????? ???????????? ???? ???????? ?????? ????????
</p>

```{r}
to_bin <- function(x, n){
  i <- 1
  out <- numeric(n)
  while (i <= n){
    new_x = as.integer(x / 2)
    out[i] = x - 2 * new_x
    x <- new_x
    i <- i + 1
  }
  return(out)
}

first_type <- function(a, b, c){
  if (a == 1){
    if(b + c != 0){
      return(FALSE)
    }
  }else{
    if(b+c == 0){
      return(FALSE)
    }
  }
  return(TRUE)
}

second_type <- function(a, b, c){
  if (a == 1){
    if(b + c != 1){
      return(FALSE)
    }
  }else{
    if(b+c == 1){
      return(FALSE)
    }
  }
  return(TRUE)
}

i <- 0
n <- 8
values <- c()
print('possible configs:')
while(i< 2 ** n){
  out <- to_bin(i, n)
  flag = TRUE
  num_first <- 0
  num_second <- 0
  num_both <- 0
  num_neither <- 0
  if (first_type(out[n], out[1], out[n-1])){
    if(second_type(out[n], out[1], out[n-1])){
      num_both <- num_both + 1
    }else{
      num_first <- num_first + 1
    }
  }else{
    if(second_type(out[n], out[1], out[n-1])){
      num_second <- num_second + 1
    }else{
      num_neither <- num_neither + 1
    }
  }
  
  if (first_type(out[1], out[n], out[2])){
    if(second_type(out[1], out[n], out[2])){
      num_both <- num_both + 1
    }else{
      num_first <- num_first + 1
    }
  }else{
    if(second_type(out[1], out[n], out[2])){
      num_second <- num_second + 1
    }else{
      num_neither <- num_neither + 1
    }
  }
  
  j <- n - 1
  while (j > 1){
    if (first_type(out[j], out[j + 1], out[j - 1])){
      if(second_type(out[j], out[j + 1], out[j - 1])){
        num_both <- num_both + 1
      }else{
        num_first <- num_first + 1
      }
    }else{
      if(second_type(out[j], out[j + 1], out[j - 1])){
        num_second <- num_second + 1
      }else{
        num_neither <- num_neither + 1
      }
    }
    j <- j - 1
  }
  if (num_neither == 0 && num_first <= 4 && num_second <= 4){
    print(out)
    values <- union(values, c(n - sum(out)))
  }
  i <- i + 1
}
print('possible vnumber of liars:')
print(values)

```

